language: python
python:
- '3.4'
branches:
  except:
  - master
  - ci
env:
  matrix:
  - FORMAT=hst TF=M1
  - FORMAT=hst TF=M2
  - FORMAT=hst TF=M3
  - FORMAT=hst TF=M4
  - FORMAT=hst TF=M5
  - FORMAT=hst TF=M6
  - FORMAT=hst TF=M10
  - FORMAT=hst TF=M12
  - FORMAT=hst TF=M15
  - FORMAT=hst TF=M20
  - FORMAT=hst TF=M30
  - FORMAT=hst TF=H1
  - FORMAT=hst TF=H2
  - FORMAT=hst TF=H3
  - FORMAT=hst TF=H4
  - FORMAT=hst TF=H6
  - FORMAT=hst TF=H8
  - FORMAT=hst TF=H12
  - FORMAT=hst TF=D1
  - FORMAT=hst TF=W1
  - FORMAT=hst TF=MN1
  - FORMAT=fxt TF=M1
  - FORMAT=fxt TF=M5
  - FORMAT=fxt TF=M15
  - FORMAT=fxt TF=M30
  - FORMAT=fxt TF=H1
  - FORMAT=fxt TF=H4
  - FORMAT=fxt TF=D1
  - FORMAT=fxt TF=W1
  - FORMAT=fxt TF=MN1
addons:
  apt:
    packages:
    - realpath
    - pv
notifications:
  email: false
before_install:
- set -e
install: 
before_script:
- curl -o Makefile https://raw.githubusercontent.com/FX-Data/FX-Data-Test/master/Makefile
script:
- make $FORMAT
after_success: 
after_failure:
- sudo apt-get -qy install tree && tree -d -L 6
- env
after_script:
- pwd
deploy:
  provider: releases
  api_key:
    secure: wFv2d292TLm9j+gmRoO+DntdmPRmwmttEr3v/iF0RDZqMvMtH6orlx0zFgJGDFj7Gp3ne76I9vktjheou4NBfbRVVJFdLM3kIQr6G6AbISVYmfUiVno3Kro8XIR9uRwIM7EI6aOfjU/UnQu6RZ9/uPPnSEoNVB146dSBkKLv20cYOIHRavU9GbaCZgElzNJr2inv9ekk3QEoIEU0kAk+uKw0aqa7VVzE4M1tIJX17A9AQMPTBk8IW7VPQBtGWGp/L2Z2d7ybT0sVE7hnkbSphAphleSGVClSSg7gBhrbgHM8OBoU1NUAr8QHvJbBLlFc+WEMF53eYX59dIk04hZBYs0D64QJtH+vSQPenl46FnroXLO6dIIYtwAN8MzrbRnASCvelsjVmfuMbw79AnWAJy9/7t/Nh2DIH1Uc5Qkd9bzqavBCbQbj6retpEpZULPaBYVarYo6ZFbrnXKHXZYYsTogKIzZ/2ptogCevi0VF1SJ5E48OFYYyv9dyunMZc4aHNN+QKM+0kHU4usM52vs46yBWYwco/L3/jNo6/lC84F2uHFHfOP3zezSaWpOPrwwz56BoG00TUgX0r9KP4mAi2pZEPUpQCpOyO573lC+whtG5qh/vR0N5fr4h24DjybD5mEHGqG79AJEVtILAgd/U9TiBDPbacpI0sftas+ciuI=
  file:
  - "*.hst.gz"
  - "*.fxt.gz"
  file_glob: true
  skip_cleanup: true
  overwrite: true
  on:
    repo: FX-Data/FX-Data-EURUSD-DS
    tags: true
after_deploy:
- make clean
